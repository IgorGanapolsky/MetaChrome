#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit checks..."

# Change to frontend directory
cd frontend 2>/dev/null || cd .

# Run preflight check
echo "â†’ Running preflight check..."
node scripts/preflight-check.js
if [ $? -ne 0 ]; then
  echo "âŒ Preflight check failed. Please fix errors before committing."
  exit 1
fi

# Run lint-staged
echo "â†’ Running lint-staged..."
npx lint-staged
if [ $? -ne 0 ]; then
  echo "âŒ Lint-staged failed. Please fix errors before committing."
  exit 1
fi

# Run config validation
echo "â†’ Validating Expo config..."
node scripts/validate-expo-config.js
if [ $? -ne 0 ]; then
  echo "âŒ Config validation failed. Please fix errors before committing."
  exit 1
fi

echo "âœ… All pre-commit checks passed!"
